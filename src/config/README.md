# Configuration

Configs can be generated and edited using:
```bash
mal -e
```

To reset to default settings, simply delete the config file. mal-cli will automatically use the default settings, and you can regenerate it with `mal -e` again.

## Default Configuration

```toml
[navigation]
nav_up = ["Up", { Char = "k" }]
nav_down = ["Down", { Char = "j" }]
nav_left = ["Left", { Char = "h" }]
nav_right = ["Right", { Char = "l" }]
select = ["Enter", { Char = " " }]
close = ["Esc", { Char = "q" }]
enable_mouse_capture = true

[network]
# where the auth backend server runs
auth_server = "https://mal-cli.dogfetus.no"
# the call back port on the local machine receiving the authorization token
callback_port = 53400
# if the port is busy the number of attempts + increments to bind to a new port
max_port_retries = 10

[player]
disable_default_player = false
always_complete_episode = false
# Optional hooks (not generated by default, but can be added manually):
# pre_playback_hook = "your-command-here"
# post_playback_hook = "your-command-here"

[theme]
primary = "DarkGray"
secondary = "White"
highlight = "LightCyan"
second_highlight = "LightYellow"
error = "Red"
text = "White"
second_text = "White"
watching = "#40C9FF"
completed = "#53D183"
on_hold = "#B56910"
dropped = "#A30000"
plan_to_watch = "#B056FF"
```

## Playback Hooks

Playback hooks allow you to run custom commands when playing anime episodes. There are two types:

### `pre_playback_hook`
Runs **immediately** when you press play on an anime, before the player starts.

**Available variables:**
- `{title}` - Anime title
- `{episode}` - Episode number

**Example:** Display a notification when starting an episode
```toml
pre_playback_hook = "notify-send 'Now playing\n{title}\n\nEpisode: {episode}'"
```

### `post_playback_hook`
Runs **after** the episode is watched (when mpv closes).

**Available variables:**
- `{title}` - Anime title
- `{episode}` - Episode number
- `{url}` - Direct video URL
- `{referrer}` - Referrer header used for the request

**Example:** Copy the episode URL to clipboard
```toml
post_playback_hook = "echo {url} | xclip -selection clipboard"
```

## Advanced Use Cases

### Using a Custom Player

If you want to use your own video player:

1. Set `disable_default_player = true`
2. Add a `post_playback_hook` that opens your preferred player:
   ```toml
   disable_default_player = true
   post_playback_hook = "mpv {url} --referrer={referrer}"
   ```

**Note:** When `disable_default_player = true`, the `post_playback_hook` runs immediately after fetching the video URL (not after watching).

### Fetching URLs Without Watching

To get episode URLs without playing them:

```toml
disable_default_player = true
always_complete_episode = false
post_playback_hook = "echo '{title} - Episode {episode}: {url} : {referrer}' >> anime_urls.txt"
```

This will save URLs to a file without:
- Opening a video player
- Marking episodes as watched on MyAnimeList

### Custom Progress Tracking

If you're using a custom player and want to manually update your MyAnimeList progress you can do that, or if you just want it to assume you have completed the anime episode whenever your hook finishes you can set `always_complete_episode` to true:

```toml
disable_default_player = true
always_complete_episode = true 
post_playback_hook = "your-custom-player {url} --referrer={referrer} "
```

With `always_complete_episode = false`, mal-cli won't automatically mark the episode as watched but will still add the anime to the "watching" list.

## Tips

- Hooks support any shell command or script
- Chain multiple commands with `&&` or `;`
- Use quotes around commands that contain spaces
- Variables are case-sensitive: use `{title}` not `{Title}`
- Referrer may be nothing ("")
